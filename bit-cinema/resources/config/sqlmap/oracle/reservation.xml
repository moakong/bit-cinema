<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
	"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
	
<!-- 여기부터 입력! -->
<mapper namespace="kr.co.bit_cinema.repository.mapper.ReservationMapper">
	
	<select id="selectMovieOrderByName" resultType="string">
		SELECT DISTINCT m.MOVIE_NAME
 		  FROM SCHEDULE S
		 INNER JOIN MOVIES M
   			ON S.MOVIE_ID = M.MOVIE_ID 
		 ORDER BY m.MOVIE_NAME
	</select>
	
	<select id="selectMovieOrderByReservation" resultType="string">
		SELECT DISTINCT M.MOVIE_NAME, R.R_NUMBERS 
		  FROM SCHEDULE S
	 	 INNER JOIN MOVIES M
	  	    ON S.MOVIE_ID = M.MOVIE_ID
		 INNER JOIN RESER_ORDER R
		    ON M.MOVIE_ID = R.MOVIE_ID
		 ORDER BY R_NUMBERS DESC
	</select>
	
	
	<resultMap type="Theater" id="theaterMap">
		<result  column="location_id" property="locationId" />
		<result  column="location_name" property="locationName" />
		<result  column="theater_id" property="theaterId" />
		<result  column="theater_name" property="theaterName" />
	</resultMap>
	
	
	<select id="selectArea" resultMap="theaterMap" parameterType="int">
		SELECT DISTINCT A.LOCATION_NAME
		  FROM SCHEDULE SCH
		 INNER JOIN SCREEN SCRN
		   ON SCH.SCREEN_ID = SCRN.SCREEN_ID AND SCH.THEATER_ID = SCRN.THEATER_ID
		 INNER JOIN THEATER T
		   ON T.THEATER_ID = SCRN.THEATER_ID
		 INNER JOIN AREAS A
		   ON T.LOCATION_ID = A.LOCATION_ID
		WHERE SCH.MOVIE_ID = #{movieId}
	</select>
	
	
</mapper>